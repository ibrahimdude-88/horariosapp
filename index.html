<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Horarios Rotativos - 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <div class="logo-container">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <h1 data-editable-id="main-title">Horarios Rotativos 2026</h1>
                </div>
                <p class="subtitle" data-editable-id="sub-title">Sistema de gestión de turnos semanales</p>
            </div>
            <div class="header-actions">
                <button id="loginBtn" class="theme-toggle" title="Iniciar Sesión Admin">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </button>
                <button id="themeToggle" class="theme-toggle" title="Alternar Modo Oscuro">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>
        </header>

        <main class="main-content">
            <!-- Tab Navigation -->
            <nav class="tabs-nav">
                <button class="tab-button" data-tab="config" id="configTabBtn" style="display: none;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                        </path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <span data-editable-id="tab-config">Configuración de Horarios</span>
                </button>
                <button class="tab-button active" data-tab="individual">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <span data-editable-id="tab-ind">Mi Horario</span>
                </button>
                <button class="tab-button" data-tab="general">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    <span data-editable-id="tab-gen">Horario General</span>
                </button>
            </nav>

            <!-- Config Tab -->
            <section id="config-tab" class="tab-content">
                <div class="controls-bar">
                    <div class="week-navigation">
                        <button id="prevWeekConfig" class="nav-btn" title="Semana Anterior">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <div class="week-info">
                            <h2 id="weekDisplayConfig">Semana 1</h2>
                            <span id="dateRangeConfig">29 Dic - 04 Ene</span>
                        </div>
                        <button id="nextWeekConfig" class="nav-btn" title="Semana Siguiente">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button id="manageAssignmentsBtn" class="btn-secondary">Gestionar Asignaciones</button>
                        <button id="manageVacationsBtn" class="btn-secondary">Gestionar Vacaciones</button>
                        <button id="manageLocationChangesBtn" class="btn-secondary">Cambio de Ubicación</button>
                        <button id="manageEventsBtn" class="btn-secondary">📅 Eventos y Avisos</button>
                        <button id="changePasswordBtn" class="btn-secondary"
                            style="background: var(--primary); color: white;">🔐 Cambiar Contraseña</button>
                        <button id="todayBtnConfig" class="today-btn">Ir a Hoy</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th>Horario</th>
                                <th>Persona Asignada</th>
                                <th>Lunes</th>
                                <th>Martes</th>
                                <th>Miércoles</th>
                                <th>Jueves</th>
                                <th>Viernes</th>
                                <th>Sábado</th>
                                <th>Domingo</th>
                            </tr>
                        </thead>
                        <tbody id="configTableBody">
                            <!-- Generated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Individual Tab -->
            <section id="individual-tab" class="tab-content active">
                <div class="controls-bar">
                    <div class="week-navigation">
                        <button id="prevWeekInd" class="nav-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <div class="week-info">
                            <h2 id="weekDisplayInd">Semana 1</h2>
                            <span id="dateRangeInd">29 Dic - 04 Ene</span>
                        </div>
                        <button id="nextWeekInd" class="nav-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>
                    </div>
                    <button id="todayBtnInd" class="today-btn">Ir a Hoy</button>
                </div>

                <div id="individualScheduleContainer" class="individual-view">
                    <!-- Generated by JS -->
                </div>
            </section>

            <!-- General Tab -->
            <section id="general-tab" class="tab-content">
                <div class="controls-bar">
                    <div class="week-navigation">
                        <button id="prevWeekGen" class="nav-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <div class="week-info">
                            <h2 id="weekDisplayGen">Semana 1</h2>
                            <span id="dateRangeGen">29 Dic - 04 Ene</span>
                        </div>
                        <button id="nextWeekGen" class="nav-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>
                    </div>
                    <button id="todayBtnGen" class="today-btn">Ir a Hoy</button>
                </div>

                <div id="eventsBannerGen"></div>

                <div class="general-view">
                    <div class="main-schedule-section">
                        <h3 data-editable-id="section-gen-full">Vista General Completa</h3>
                        <div class="table-container">
                            <table class="schedule-table">
                                <thead>
                                    <tr>
                                        <th>Persona</th>
                                        <th>Lunes</th>
                                        <th>Martes</th>
                                        <th>Miércoles</th>
                                        <th>Jueves</th>
                                        <th>Viernes</th>
                                        <th>Sábado</th>
                                        <th>Domingo</th>
                                    </tr>
                                </thead>
                                <tbody id="generalTableBody">
                                    <!-- Generated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="locations-section">
                        <h3 data-editable-id="section-locations">Personal por Ubicación</h3>
                        <div class="locations-grid">
                            <div class="location-card guardia">
                                <div class="location-header" data-editable-id="loc-guardia">GUARDIA</div>
                                <div class="location-content" id="guardiaList"></div>
                            </div>
                            <div class="location-card valle">
                                <div class="location-header" data-editable-id="loc-valle">VALLE</div>
                                <div class="location-content" id="valleList"></div>
                            </div>
                            <div class="location-card mitras">
                                <div class="location-header" data-editable-id="loc-mitras">MITRAS</div>
                                <div class="location-content" id="mitrasList"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Iniciar Sesión</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" id="loginPass" placeholder="••••••">
                </div>
                <div id="loginError" style="display: none; color: var(--danger); margin-top: 0.5rem;">
                    Usuario o contraseña incorrectos
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cancelar</button>
                <button id="doLoginBtn" class="btn-primary">Iniciar Sesión</button>
            </div>
        </div>
    </div>

    <!-- Assignment Modal -->
    <div id="assignModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Asignar Persona - Horario <span id="modalScheduleId"></span></h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cancelar</button>
                <button id="saveAssignBtn" class="btn-primary">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Swap Modal -->
    <div id="swapModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Cambio de Guardia</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cancelar</button>
                <button id="saveSwapBtn" class="btn-primary">Guardar Cambio</button>
            </div>
        </div>
    </div>

    <!-- Vacations Modal -->
    <div id="vacationsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestionar Vacaciones</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Location Change Modal -->
    <div id="locationChangeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Cambio de Ubicación</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Cambiar Contraseña de Administrador</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Contraseña Actual</label>
                    <input type="password" id="currentPassword" placeholder="Ingresa tu contraseña actual">
                </div>
                <div class="form-group">
                    <label>Nueva Contraseña</label>
                    <input type="password" id="newPassword" placeholder="Ingresa la nueva contraseña">
                </div>
                <div class="form-group">
                    <label>Confirmar Nueva Contraseña</label>
                    <input type="password" id="confirmPassword" placeholder="Confirma la nueva contraseña">
                </div>
                <div id="passwordError" style="display: none; color: var(--danger); margin-top: 0.5rem;"></div>
                <div id="passwordSuccess" style="display: none; color: var(--success); margin-top: 0.5rem;">
                    ✅ Contraseña cambiada exitosamente
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cancelar</button>
                <button id="savePasswordBtn" class="btn-primary">Cambiar Contraseña</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 id="confirmTitle">Confirmar</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage" style="margin: 0;"></p>
            </div>
            <div class="modal-footer">
                <button id="confirmCancelBtn" class="btn-secondary">Cancelar</button>
                <button id="confirmOkBtn" class="btn-primary" style="background: var(--danger);">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Events Management Modal -->
    <div id="eventsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestionar Eventos y Avisos</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Fecha</label>
                    <input type="date" id="eventDate">
                </div>
                <div class="form-group">
                    <label>Tipo de Evento</label>
                    <select id="eventType">
                        <option value="notice">Aviso General (Azul)</option>
                        <option value="holiday">Día Festivo / Asueto (Verde)</option>
                        <option value="alert">Alerta Importante (Rojo)</option>
                        <option value="payday">Quincena (Dorado)</option>
                    </select>
                </div>

                <!-- Campos para horario especial de guardia (solo visible para holiday) -->
                <div id="guardiaTimeContainer"
                    style="display: none; background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 1px solid rgba(16, 185, 129, 0.3);">
                    <label
                        style="color: var(--success); font-weight: bold; margin-bottom: 0.5rem; display: block;">Horario
                        Especial Guardia (Opcional)</label>
                    <div style="display: flex; gap: 1rem;">
                        <div style="flex: 1;">
                            <label style="font-size: 0.8rem;">Entrada</label>
                            <input type="time" id="guardiaStart">
                        </div>
                        <div style="flex: 1;">
                            <label style="font-size: 0.8rem;">Salida</label>
                            <input type="time" id="guardiaEnd">
                        </div>
                    </div>
                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem; margin-bottom: 0;">Si se
                        deja vacío, se usa el horario normal.</p>
                </div>

                <div class="form-group">
                    <label>Mensaje del Evento</label>
                    <input type="text" id="eventText" placeholder="Ej: Juntá de equipo a las 10am">
                </div>

                <h4 style="margin-top: 2rem; margin-bottom: 1rem;">Eventos Próximos</h4>
                <div id="eventsList" style="max-height: 200px; overflow-y: auto;">
                    <!-- Lista de eventos generada por JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal">Cerrar</button>
                <button id="saveEventBtn" class="btn-primary">Guardar Evento</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK (Version 8 stable for direct HTML usage) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <!-- App Logic -->
    <script src="app.js" defer></script>
</body>

</html>